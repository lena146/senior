<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ì‹œë‹ˆì–´ ì—¬í–‰ í”Œë˜ë„ˆ</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --color-primary: #2d5a4a;
      --color-primary-light: #3d7a64;
      --color-primary-dark: #1e3d32;
      --color-accent: #e8b86d;
      --color-accent-soft: #f5e6d3;
      --color-bg: #faf8f5;
      --color-card: #ffffff;
      --color-text: #2c2c2c;
      --color-text-muted: #666;
      --color-border: #e8e4df;
      --font-sans: 'Noto Sans KR', -apple-system, sans-serif;
      --radius: 16px;
      --radius-sm: 12px;
      --shadow: 0 4px 20px rgba(45, 90, 74, 0.08);
      --safe-bottom: 0px;
    }
    * { box-sizing: border-box; }
    html { font-size: 16px; -webkit-text-size-adjust: 100%; }
    body {
      margin: 0;
      font-family: var(--font-sans);
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.5;
      min-height: 100vh;
      padding-bottom: 80px;
    }
    #app { min-height: 100vh; max-width: 480px; margin: 0 auto; }
    .page { padding: 0 20px 100px; }
    .hidden { display: none !important; }

    .hero { text-align: center; padding: 32px 0 40px; }
    .hero h1 { margin: 0 0 12px; font-size: 1.75rem; font-weight: 700; color: var(--color-primary-dark); }
    .hero p { margin: 0; font-size: 1rem; color: var(--color-text-muted); }
    .cards { display: flex; flex-direction: column; gap: 16px; }
    .card {
      display: block;
      background: var(--color-card);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      border: 1px solid var(--color-border);
      text-decoration: none;
      color: inherit;
      position: relative;
    }
    .card:hover { border-color: var(--color-primary-light); }
    .cardIcon { font-size: 2rem; display: block; margin-bottom: 12px; }
    .card h2 { margin: 0 0 8px; font-size: 1.15rem; font-weight: 600; }
    .card p { margin: 0; font-size: 0.9rem; color: var(--color-text-muted); }
    .badge {
      position: absolute; top: 16px; right: 16px;
      padding: 4px 10px; border-radius: 999px;
      background: var(--color-accent-soft); color: var(--color-primary-dark);
      font-size: 0.75rem; font-weight: 600;
    }
    .footer-note { margin-top: 32px; padding-top: 24px; border-top: 1px solid var(--color-border); font-size: 0.85rem; color: var(--color-text-muted); text-align: center; }

    .nav {
      position: fixed; bottom: 0; left: 0; right: 0;
      max-width: 480px; margin: 0 auto;
      display: flex; justify-content: space-around; align-items: center;
      height: 64px; background: var(--color-card);
      border-top: 1px solid var(--color-border);
      z-index: 100; box-shadow: 0 -4px 20px rgba(0,0,0,0.06);
    }
    .nav a {
      display: flex; flex-direction: column; align-items: center; gap: 4px;
      padding: 8px 12px; text-decoration: none; color: var(--color-text-muted);
      font-size: 0.75rem; font-weight: 500; border-radius: var(--radius-sm);
    }
    .nav a:hover, .nav a.active { color: var(--color-primary); background: var(--color-accent-soft); }

    .survey-header { padding: 24px 0 16px; }
    .survey-header h1 { margin: 0 0 8px; font-size: 1.5rem; font-weight: 700; color: var(--color-primary-dark); }
    .survey-header p { margin: 0 0 16px; font-size: 0.9rem; color: var(--color-text-muted); }
    .progress { height: 6px; background: var(--color-border); border-radius: 3px; overflow: hidden; margin-bottom: 8px; }
    .progress-bar { height: 100%; background: var(--color-primary); border-radius: 3px; transition: width 0.3s; }
    .step-label { font-size: 0.85rem; color: var(--color-text-muted); }
    .section { margin-bottom: 32px; }
    .section h2 { margin: 0 0 16px; font-size: 1.1rem; font-weight: 600; }
    .icon-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .icon-card {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      min-height: 100px; padding: 16px 8px;
      background: var(--color-card); border: 2px solid var(--color-border);
      border-radius: var(--radius-sm); color: var(--color-text);
      cursor: pointer; transition: all 0.2s; box-shadow: var(--shadow);
    }
    .icon-card:hover { border-color: var(--color-primary-light); }
    .icon-card.selected { border-color: var(--color-primary); background: var(--color-accent-soft); color: var(--color-primary-dark); }
    .icon-wrap { width: 48px; height: 48px; margin-bottom: 8px; }
    .icon-wrap svg { width: 100%; height: 100%; }
    .icon-label { font-size: 0.8rem; font-weight: 500; text-align: center; }
    .chip-grid { display: flex; flex-wrap: wrap; gap: 10px; }
    .chip {
      padding: 12px 20px; border-radius: 999px;
      border: 2px solid var(--color-border); background: var(--color-card);
      font-size: 0.95rem; font-weight: 500; color: var(--color-text);
      cursor: pointer; transition: all 0.2s; font-family: inherit;
    }
    .chip:hover { border-color: var(--color-primary-light); }
    .chip.selected { border-color: var(--color-primary); background: var(--color-primary); color: white; }
    .survey-footer {
      position: fixed; bottom: 64px; left: 0; right: 0; max-width: 480px; margin: 0 auto;
      padding: 16px 20px; background: var(--color-bg); border-top: 1px solid var(--color-border);
      display: flex; gap: 12px; justify-content: flex-end;
    }
    .btn-primary {
      flex: 1; min-height: 48px; padding: 14px 24px;
      background: var(--color-primary); color: white; border: none;
      border-radius: var(--radius-sm); font-size: 1rem; font-weight: 600;
      cursor: pointer; font-family: inherit;
    }
    .btn-primary:hover { background: var(--color-primary-light); }
    .btn-secondary {
      min-height: 48px; padding: 14px 20px;
      background: var(--color-card); color: var(--color-text);
      border: 2px solid var(--color-border); border-radius: var(--radius-sm);
      font-size: 1rem; font-weight: 600; cursor: pointer; font-family: inherit;
    }

    .curation-header { padding: 24px 0 20px; }
    .curation-header h1 { margin: 0 0 4px; font-size: 1.4rem; font-weight: 700; }
    .curation-dest { margin: 0 0 8px; font-size: 1rem; font-weight: 600; color: var(--color-primary); }
    .curation-summary { margin: 0; font-size: 0.9rem; color: var(--color-text-muted); }
    .top3-section { margin-bottom: 28px; }
    .top3-section h2 { margin: 0 0 8px; font-size: 1.1rem; }
    .top3-desc { margin: 0 0 16px; font-size: 0.85rem; color: var(--color-text-muted); }
    .top3-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    .top3-card {
      background: var(--color-card); border-radius: var(--radius-sm);
      padding: 14px; box-shadow: var(--shadow); border: 1px solid var(--color-border);
    }
    .top3-label { font-size: 0.85rem; font-weight: 600; display: block; margin-bottom: 8px; }
    .top3-list { margin: 0; padding-left: 1.1em; font-size: 0.8rem; color: var(--color-text-muted); line-height: 1.5; }
    .tabs { display: flex; gap: 8px; margin-bottom: 16px; overflow-x: auto; padding-bottom: 4px; }
    .tab {
      flex-shrink: 0; display: flex; align-items: center; gap: 6px;
      padding: 10px 14px; border-radius: 999px;
      border: 2px solid var(--color-border); background: var(--color-card);
      font-size: 0.9rem; font-weight: 500; cursor: pointer; font-family: inherit;
    }
    .tab.active { border-color: var(--color-primary); background: var(--color-accent-soft); color: var(--color-primary-dark); }
    .list-card {
      background: var(--color-card); border-radius: var(--radius-sm);
      padding: 16px; margin-bottom: 12px; box-shadow: var(--shadow);
      border: 1px solid var(--color-border);
    }
    .list-card h3 { margin: 0 0 4px; font-size: 1rem; font-weight: 600; }
    .list-card .note { margin: 0 0 6px; font-size: 0.9rem; color: var(--color-text-muted); }
    .list-card .price { font-size: 0.9rem; font-weight: 600; color: var(--color-primary); }
    .tag { display: inline-block; padding: 4px 10px; margin: 2px; border-radius: 999px; background: var(--color-accent-soft); color: var(--color-primary-dark); font-size: 0.75rem; }
    .curation-footer { padding: 24px 0 100px; }
    .curation-footer .btn-primary { display: block; width: 100%; text-align: center; text-decoration: none; line-height: 48px; }

    .planner-header { padding: 24px 0 20px; }
    .planner-header h1 { margin: 0 0 4px; font-size: 1.4rem; font-weight: 700; }
    .planner-meta { margin: 0 0 12px; font-size: 1rem; color: var(--color-primary); font-weight: 500; }
    .planner-badges { display: flex; gap: 10px; flex-wrap: wrap; }
    .planner-badge { padding: 6px 12px; border-radius: 999px; background: var(--color-accent-soft); color: var(--color-primary-dark); font-size: 0.85rem; }
    .planner-tips { margin-bottom: 24px; }
    .planner-tips h2 { margin: 0 0 10px; font-size: 1.05rem; }
    .planner-tips ul { margin: 0; padding-left: 1.2em; font-size: 0.9rem; color: var(--color-text-muted); line-height: 1.6; }
    .day-card {
      background: var(--color-card); border-radius: var(--radius);
      padding: 18px; margin-bottom: 20px; box-shadow: var(--shadow);
      border: 1px solid var(--color-border);
    }
    .day-card h3 { margin: 0 0 14px; font-size: 1.1rem; font-weight: 600; color: var(--color-primary-dark); padding-bottom: 10px; border-bottom: 2px solid var(--color-accent-soft); }
    .slot { padding: 12px 0; border-bottom: 1px solid var(--color-border); }
    .slot:last-child { border-bottom: none; }
    .slot-time { font-size: 0.8rem; color: var(--color-primary); font-weight: 600; }
    .slot-label { font-size: 1rem; font-weight: 600; }
    .slot-note { font-size: 0.85rem; color: var(--color-text-muted); }
    .planner-footer { padding: 24px 0 100px; }
    .planner-footer .btn-secondary { width: 100%; }
    .planner-hint { margin: 10px 0 0; font-size: 0.8rem; color: var(--color-text-muted); text-align: center; }
  </style>
</head>
<body>
  <div id="app"></div>
  <nav class="nav" id="nav">
    <a href="#/" id="nav-home" class="active">ğŸ  í™ˆ</a>
    <a href="#/survey" id="nav-survey">ğŸ“‹ í”„ë¡œí•„</a>
    <a href="#/curation" id="nav-curation">âœˆï¸ ì—¬í–‰ì •ë³´</a>
    <a href="#/planner" id="nav-planner">ğŸ“… ì¼ì •</a>
  </nav>

  <script>
(function() {
  var CURATION = {"ì œì£¼ë„":{"summary":"ì œì£¼ëŠ” íœ´ì–‘ê³¼ ìì—°, ë§›ì§‘ì´ ì–´ìš°ëŸ¬ì§„ ì‹œë‹ˆì–´ ì¹œí™” ì½”ìŠ¤ê°€ ë§ìŠµë‹ˆë‹¤.","accommodation":[{"id":1,"name":"ì œì£¼ í•œë‹´í•´ë³€ íœì…˜","type":"íœì…˜","price":"8ë§Œì›~","note":"ë°”ë‹¤ ì „ë§, ì£¼ì°¨ ê°€ëŠ¥","score":4.8,"source":"ë¸”ë¡œê·¸"},{"id":2,"name":"ì„œê·€í¬ ì‹œë‹ˆì–´ ë§ì¶¤ ìˆ™ì†Œ","type":"ë¯¼ë°•","price":"5ë§Œì›~","note":"ì¡°ì‹ í¬í•¨, í‰íƒ„í•œ ì¶œì…","score":4.6,"source":"ê³µê³µë°ì´í„°"},{"id":3,"name":"ì œì£¼ ì˜¬ë ˆê¸¸ ê·¼ì²˜ ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤","type":"ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤","price":"4ë§Œì›~","note":"ê±·ê¸° ì½”ìŠ¤ ì¸ì ‘","score":4.5,"source":"ìœ íŠœë¸Œ"}],"transport":[{"id":1,"name":"ì œì£¼ ì‹œì™¸ë²„ìŠ¤ (ê³µí•­â†”ì„œê·€í¬)","note":"ì €ìƒë²„ìŠ¤ ë‹¤ìˆ˜, ë°°ì°¨ ì¦ìŒ","tip":"ì œì£¼ë²„ìŠ¤ ì•±ìœ¼ë¡œ ì‹¤ì‹œê°„ í™•ì¸"},{"id":2,"name":"ë Œí„°ì¹´ (ê²½ì°¨/ì†Œí˜•)","note":"ì‹œë‹ˆì–´ í• ì¸ ì—…ì²´ ìˆìŒ","tip":"ì£¼ì°¨ ì‰¬ìš´ ìˆ™ì†Œ ì¶”ì²œ"},{"id":3,"name":"ê´€ê´‘íƒì‹œ (4ì‹œê°„/8ì‹œê°„)","note":"ë§ì¶¤ ì½”ìŠ¤ ê°€ëŠ¥","tip":"ì²´ë ¥ ê³ ë ¤ ì‹œ ì¶”ì²œ"}],"attraction":[{"id":1,"name":"ì„±ì‚°ì¼ì¶œë´‰","note":"ì™„ë§Œí•œ ì‚°ì±…ë¡œ, ì „ë™ì°¨ ì´ë™ ê°€ëŠ¥","level":"ì‰¬ì›€"},{"id":2,"name":"ìš°ë„ ìì „ê±°Â·ì „ê¸°ì°¨","note":"ë°˜ë‚˜ì ˆ ì½”ìŠ¤, íœ´ì‹ í¬ì¸íŠ¸ ë§ìŒ","level":"ë³´í†µ"},{"id":3,"name":"ì„œê·€í¬ ì˜¬ë ˆ 6ì½”ìŠ¤","note":"í•´ì•ˆ ì‚°ì±…, êµ¬ê°„ ì„ íƒ ê°€ëŠ¥","level":"ì‰¬ì›€~ë³´í†µ"}],"food":[{"id":1,"name":"í‘ë¼ì§€ ë§›ì§‘ (ì„œê·€í¬)","note":"ì£¼ì°¨Â·ëŒ€ê¸° ê³µê°„ ë„“ìŒ","tags":["ë§›ì§‘","ì£¼ì°¨"]},{"id":2,"name":"í•´ë…€ì˜ ì§‘","note":"ì‹ ì„ í•œ í•´ì‚°ë¬¼, ë‹¨ì²´ì„","tags":["í•´ì‚°ë¬¼","ë‹¨ì²´"]},{"id":3,"name":"ì œì£¼ ì „í†µì‹ë‹¹","note":"ë‹´ë°±í•œ êµ­ë¬¼Â·ë°¥ ìœ„ì£¼","tags":["ì „í†µ","ë‹´ë°±"]}]},"ë¶€ì‚°Â·ê²½ë‚¨":{"summary":"í•´ìš´ëŒ€Â·ê¸°ì¥Â·í†µì˜ ë“± í•´ì•ˆê³¼ ë¬¸í™”ì‹œì„¤ì´ ì˜ ê°–ì¶°ì§„ ì§€ì—­ì…ë‹ˆë‹¤.","accommodation":[{"id":1,"name":"í•´ìš´ëŒ€ ê·¼ì²˜ í˜¸í…”","type":"í˜¸í…”","price":"12ë§Œì›~","note":"ì—˜ë¦¬ë² ì´í„°, í•´ë³€ ì¸ì ‘","score":4.7,"source":"ë¸”ë¡œê·¸"}],"transport":[{"id":1,"name":"ë¶€ì‚° ë„ì‹œì² ë„","note":"ì €ìƒÂ·ì—˜ë¦¬ë² ì´í„° ì—­ ë§ìŒ","tip":"1ì¼ê¶Œ ì¶”ì²œ"}],"attraction":[{"id":1,"name":"í•´ìš´ëŒ€ í•´ìˆ˜ìš•ì¥Â·ë™ë°±ì„¬","note":"í‰íƒ„í•œ ì‚°ì±…ë¡œ","level":"ì‰¬ì›€"}],"food":[{"id":1,"name":"ë¶€ì‚° ë°€ë©´Â·ë¼ì§€êµ­ë°¥","note":"ë§¤ì¥ ë„“ì€ ê³³ ë‹¤ìˆ˜","tags":["ë°€ë©´","êµ­ë°¥"]}]},"ê°•ë¦‰Â·ë™í•´":{"summary":"ë°”ë‹¤ì™€ ì‚°ì´ ë§ë‹¿ì€ ë™í•´ì•ˆ, íœ´ì–‘ê³¼ ë§›ì§‘ì´ ì˜ ì–´ìš¸ë¦½ë‹ˆë‹¤.","accommodation":[{"id":1,"name":"ê°•ë¦‰ ê²½í¬ëŒ€ ì¸ê·¼ ìˆ™ì†Œ","type":"í˜¸í…”/íœì…˜","price":"10ë§Œì›~","note":"í•´ë³€ ì¸ì ‘, í‰íƒ„","score":4.6,"source":"ë¸”ë¡œê·¸"}],"transport":[{"id":1,"name":"ê°•ë¦‰ ì‹œë‚´ë²„ìŠ¤","note":"ê²½í¬ëŒ€Â·ì •ë™ì§„ ë…¸ì„ ","tip":"ë²„ìŠ¤ ì‹œê°„í‘œ ë¯¸ë¦¬ í™•ì¸"}],"attraction":[{"id":1,"name":"ê²½í¬ëŒ€Â·ê²½í¬í•´ìˆ˜ìš•ì¥","note":"í‰íƒ„í•œ í•´ë³€ ì‚°ì±…","level":"ì‰¬ì›€"}],"food":[{"id":1,"name":"ê°•ë¦‰ ì´ˆë‹¹ë‘ë¶€","note":"ë‹´ë°±í•œ ë‘ë¶€ ìš”ë¦¬","tags":["ë‘ë¶€","ë‹´ë°±"]}]},"ì „ì£¼Â·ì „ë¶":{"summary":"í•œì˜¥ë§ˆì„ê³¼ ë§›ì§‘, ì—­ì‚¬ê°€ ìˆëŠ” ì „ì£¼Â·ì „ë¶ì…ë‹ˆë‹¤.","accommodation":[{"id":1,"name":"ì „ì£¼ í•œì˜¥ë§ˆì„ í•œì˜¥ì²´í—˜","type":"í•œì˜¥ìˆ™ë°•","price":"9ë§Œì›~","note":"ì „í†µ ì²´í—˜, í‰íƒ„","score":4.7,"source":"ë¸”ë¡œê·¸"}],"transport":[{"id":1,"name":"ì „ì£¼ ì‹œë‚´ë²„ìŠ¤","note":"í•œì˜¥ë§ˆì„Â·ê²½ê¸°ì „ ë…¸ì„ ","tip":"ì‹œë‚´ ìˆœí™˜ í™œìš©"}],"attraction":[{"id":1,"name":"ì „ì£¼ í•œì˜¥ë§ˆì„","note":"ì™„ë§Œí•œ ì˜¤ì†”ê¸¸, íœ´ì‹ ê³µê°„ ë§ìŒ","level":"ì‰¬ì›€"}],"food":[{"id":1,"name":"ì „ì£¼ ë¹„ë¹”ë°¥Â·í•œì •ì‹","note":"í•œì˜¥ë§ˆì„ ë§›ì§‘","tags":["ë¹„ë¹”ë°¥","í•œì •ì‹"]}]},"ê²½ì£¼":{"summary":"ì—­ì‚¬ì™€ ë¬¸í™”ê°€ ì‚´ì•„ ìˆëŠ” ê²½ì£¼ì…ë‹ˆë‹¤.","accommodation":[{"id":1,"name":"ê²½ì£¼ ë³´ë¬¸ë‹¨ì§€ í˜¸í…”","type":"í˜¸í…”","price":"11ë§Œì›~","note":"í˜¸í…” ë°€ì§‘, êµí†µ í¸","score":4.6,"source":"ë¸”ë¡œê·¸"}],"transport":[{"id":1,"name":"ê²½ì£¼ ì‹œë‚´ë²„ìŠ¤Â·ê´€ê´‘ë²„ìŠ¤","note":"ì£¼ìš” ìœ ì  ì—°ê²°","tip":"1ì¼ê¶Œ ì¶”ì²œ"}],"attraction":[{"id":1,"name":"ëŒ€ë¦‰ì›Â·ì²¨ì„±ëŒ€","note":"í‰íƒ„í•œ ê³µì› ì‚°ì±…","level":"ì‰¬ì›€"}],"food":[{"id":1,"name":"ê²½ì£¼ í•œì •ì‹Â·í™©ë‚¨ë¹µ","note":"ì „í†µ ê³¼ìÂ·ì‹ì‚¬","tags":["í•œì •ì‹","í™©ë‚¨ë¹µ"]}]},"ê¸°íƒ€":{"summary":"ë‹¤ì–‘í•œ ì§€ì—­ì˜ ì‹œë‹ˆì–´ ì¹œí™” ì •ë³´ë¥¼ ì¶”í›„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.","accommodation":[{"id":1,"name":"ì§€ì—­ë³„ ì‹œë‹ˆì–´ ë§ì¶¤ ìˆ™ì†Œ","type":"ë‹¤ì–‘","price":"ë¬¸ì˜","note":"í‰íƒ„í•œ ì¶œì…, ì¡°ì‹ ì˜µì…˜","score":4.5,"source":"ê³µê³µë°ì´í„°"}],"transport":[{"id":1,"name":"ì‹œì™¸ë²„ìŠ¤Â·ì² ë„","note":"ì €ìƒë²„ìŠ¤ ë…¸ì„  ì‚¬ì „ í™•ì¸","tip":"ì§€ì—­ë³„ êµí†µì •ë³´ ì•±"}],"attraction":[{"id":1,"name":"ì§€ì—­ ê³µì›Â·í•´ë³€","note":"í‰íƒ„í•œ ì‚°ì±…ë¡œ ìœ„ì£¼","level":"ì‰¬ì›€"}],"food":[{"id":1,"name":"ì§€ì—­ ëŒ€í‘œ ìŒì‹","note":"ë‹´ë°±Â·ì €ì—¼ ì˜µì…˜ ìš”ì²­","tags":["ì§€ì—­ë§›"]}]}};

  var profile = {
    exerciseLevel: null, restNeed: null, conditions: [], travelStyle: [],
    destination: '', duration: null
  };
  try {
    var saved = localStorage.getItem('seniorTravelProfile');
    if (saved) profile = Object.assign(profile, JSON.parse(saved));
  } catch (e) {}
  function saveProfile() {
    try { localStorage.setItem('seniorTravelProfile', JSON.stringify(profile)); } catch (e) {}
  }

  function getDifficulty() {
    var p = profile, s = 3;
    if (p.exerciseLevel === 1) s--; if (p.exerciseLevel === 3) s++;
    if (p.restNeed === 3) s--; if (p.restNeed === 1) s++;
    if (p.conditions && p.conditions.length > 0) s--;
    return Math.max(1, Math.min(5, s));
  }
  function getPace() {
    var d = getDifficulty();
    if (d <= 2) return { activitiesPerDay: 2, restSlots: 2, label: 'ì—¬ìœ ' };
    if (d >= 4) return { activitiesPerDay: 4, restSlots: 1, label: 'í™œë°œ' };
    return { activitiesPerDay: 3, restSlots: 1, label: 'ë³´í†µ' };
  }
  function buildDay(dayIndex, totalDays) {
    var pace = getPace(), styles = (profile.travelStyle && profile.travelStyle.length) ? profile.travelStyle : ['relax'];
    var isFirst = dayIndex === 0, isLast = dayIndex === totalDays - 1, slots = [];
    if (isFirst) {
      slots.push({ type: 'move', label: 'ì¶œë°œÂ·ì´ë™', time: 'ì˜¤ì „', note: 'í¸í•œ ë³µì¥, í•„ìš”ì‹œ ì¤‘ê°„ íœ´ì‹' });
      slots.push({ type: 'rest', label: 'ìˆ™ì†Œ ë„ì°©Â·íœ´ì‹', time: 'ì ì‹¬ ì „í›„', note: 'ì§ í’€ê³  ì ê¹ ì‰¬ê¸°' });
    }
    if (styles.indexOf('culture') >= 0) slots.push({ type: 'culture', label: 'ë¬¸í™”Â·ì—­ì‚¬ ê´€ê´‘', time: 'ì˜¤ì „', note: 'ê´€ê´‘ì§€ 1ê³³, íœ´ì‹ í¬ì¸íŠ¸ í¬í•¨' });
    if (pace.restSlots >= 2) slots.push({ type: 'rest', label: 'íœ´ì‹Â·ì¹´í˜', time: 'ì˜¤í›„ ì´ˆ', note: 'ìŒë£ŒÂ·ê°„ë‹¨í•œ íœ´ì‹' });
    if (styles.indexOf('relax') >= 0) slots.push({ type: 'relax', label: 'íœ´ì–‘Â·ì‚°ì±…', time: 'ì˜¤í›„', note: 'í•´ë³€Â·ê³µì› ë“± í‰íƒ„í•œ ì½”ìŠ¤' });
    if (styles.indexOf('activity') >= 0 && pace.activitiesPerDay >= 3) slots.push({ type: 'activity', label: 'ê°€ë²¼ìš´ í™œë™', time: 'ì˜¤í›„', note: 'ë‚œì´ë„ ì¡°ì ˆëœ ì½”ìŠ¤' });
    if (pace.restSlots >= 1 && !slots.some(function(s){ return s.type === 'rest' && s.label === 'íœ´ì‹Â·ì¹´í˜'; })) slots.push({ type: 'rest', label: 'íœ´ì‹Â·ì¹´í˜', time: 'ì¤‘ê°„', note: 'ìŒë£ŒÂ·ê°„ë‹¨í•œ íœ´ì‹' });
    if (isLast) slots.push({ type: 'move', label: 'ê·€ê°€ ì´ë™', time: 'ì˜¤í›„', note: 'ì²´í¬ì•„ì›ƒ í›„ ì—¬ìœ  ìˆê²Œ' });
    return { day: dayIndex + 1, dateLabel: (dayIndex + 1) + 'ì¼ì°¨', slots: slots.slice(0, 6) };
  }
  function generateItinerary() {
    var duration = profile.duration != null ? profile.duration : 2;
    var totalDays = duration + 1, difficulty = getDifficulty(), pace = getPace();
    var dest = profile.destination || 'ì œì£¼ë„';
    var days = []; for (var d = 0; d < totalDays; d++) days.push(buildDay(d, totalDays));
    var tips = [];
    if (pace.restSlots >= 2) tips.push('ì˜¤ì „Â·ì˜¤í›„ì— ì§§ì€ íœ´ì‹ ì·¨í•˜ê¸°');
    if (profile.conditions && profile.conditions.length > 0) tips.push('í•„ìš”í•œ ì•½Â·ë³´ì¡°ìš©í’ˆ ì±™ê¸°ê¸°');
    if (profile.restNeed >= 2) tips.push('ì ì‹¬ í›„ 30ë¶„~1ì‹œê°„ íœ´ì‹ ê¶Œì¥');
    return { destination: dest, totalDays: totalDays, difficultyLabel: difficulty <= 2 ? 'ì—¬ìœ ' : difficulty >= 4 ? 'í™œë°œ' : 'ë³´í†µ', paceLabel: pace.label, days: days, tips: tips };
  }

  var step = 1;
  var curCategory = 'accommodation';
  var itineraryKey = 0;

  var ICONS = {
    exerciseLow: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M24 40 L32 28 L40 40" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="32" cy="20" r="4" fill="currentColor"/></svg>',
    exerciseMid: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M20 44 L28 32 L36 32 L44 44" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="32" cy="24" r="4" fill="currentColor"/></svg>',
    exerciseHigh: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M18 46 L26 34 L32 34 L38 34 L46 46" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="32" cy="22" r="4" fill="currentColor"/></svg>',
    restLow: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M22 36 L26 36 L30 36 L34 36 L38 36 L42 36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="32" cy="44" r="3" fill="currentColor"/></svg>',
    restMid: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M24 38 L28 38 L32 38 L36 38 L40 38" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="32" cy="46" r="4" fill="currentColor"/></svg>',
    restHigh: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M26 40 L32 40 L38 40" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="32" cy="48" r="5" fill="currentColor"/></svg>',
    activity: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M32 18 L32 46 M24 26 L32 18 L40 26 M24 38 L32 46 L40 38" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
    relax: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M20 38 Q32 28 44 38" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/><circle cx="32" cy="36" r="6" fill="currentColor" opacity="0.5"/></svg>',
    culture: '<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="2" fill="none"/><path d="M32 20 L34 28 L32 32 L30 28 Z" fill="currentColor"/><rect x="28" y="32" width="8" height="14" rx="1" stroke="currentColor" stroke-width="2" fill="none"/><path d="M24 46 L40 46" stroke="currentColor" stroke-width="2"/></svg>',
    heart: '<svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24 42 L8 26 C4 22 4 16 8 12 C12 8 18 8 24 14 C30 8 36 8 40 12 C44 16 44 22 40 26 Z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/></svg>',
    joint: '<svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="24" r="6" stroke="currentColor" stroke-width="2"/><circle cx="24" cy="24" r="6" stroke="currentColor" stroke-width="2"/><circle cx="36" cy="24" r="6" stroke="currentColor" stroke-width="2"/><path d="M18 24 L30 24" stroke="currentColor" stroke-width="2"/></svg>',
    sleep: '<svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24 8 L24 24 L36 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 28 L20 28 L20 36 L12 36 Z" stroke="currentColor" stroke-width="2" fill="none"/></svg>',
    eye: '<svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="24" cy="26" rx="14" ry="10" stroke="currentColor" stroke-width="2" fill="none"/><circle cx="24" cy="26" r="4" stroke="currentColor" stroke-width="2" fill="none"/><path d="M10 14 L24 8 L38 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',
    none: '<svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="12" stroke="currentColor" stroke-width="2" fill="none"/><path d="M18 18 L30 30 M30 18 L18 30" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'
  };

  function renderHome() {
    var hasProfile = profile.destination && profile.duration != null;
    return '<div class="page"><div class="hero"><h1>ì‹œë‹ˆì–´ ì—¬í–‰ í”Œë˜ë„ˆ</h1><p>ê±´ê°•ê³¼ ì„±í–¥ì— ë§ëŠ” ì—¬í–‰ ì •ë³´ì™€ ì¼ì •ì„ ì¶”ì²œí•´ ë“œë ¤ìš”</p></div><div class="cards"><a href="#/survey" class="card"><span class="cardIcon">ğŸ“‹</span><h2>ë‚˜ì˜ í”„ë¡œí•„</h2><p>ê±´ê°• ìƒíƒœ, ì—¬í–‰ ì„±í–¥, ì„ í˜¸ ì§€ì—­Â·ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”</p>' + (hasProfile ? '<span class="badge">ì„¤ì •ë¨</span>' : '') + '</a><a href="#/curation" class="card"><span class="cardIcon">âœˆï¸</span><h2>ì—¬í–‰ ì •ë³´</h2><p>ìˆ™ì†ŒÂ·êµí†µÂ·ê´€ê´‘Â·ë§›ì§‘ Top 3ì™€ ìƒì„¸ íë ˆì´ì…˜</p></a><a href="#/planner" class="card"><span class="cardIcon">ğŸ“…</span><h2>ë§ì¶¤ ì¼ì •</h2><p>í”„ë¡œí•„ì— ë§ì¶˜ ì¼ì • ìë™ ìƒì„±Â·ì¬ìƒì„±</p></a></div><p class="footer-note">ë¨¼ì € ë‚˜ì˜ í”„ë¡œí•„ì„ ì…ë ¥í•œ ë’¤, ì—¬í–‰ ì •ë³´ë¥¼ ë³´ê³  ì¼ì •ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”.</p></div>';
  }

  function renderSurvey() {
    var h = '<div class="page"><header class="survey-header"><h1>ë‚˜ì˜ ì—¬í–‰ í”„ë¡œí•„</h1><p>ê±´ê°•ê³¼ ì„±í–¥ì— ë§ëŠ” ë§ì¶¤ ì¼ì •ì„ ë§Œë“¤ì–´ ë“œë ¤ìš”</p><div class="progress"><div class="progress-bar" style="width:' + (step/4*100) + '%"></div></div><span class="step-label">' + step + ' / 4</span></header><main style="padding:8px 0">';
    if (step === 1) {
      h += '<section class="section"><h2>í‰ì†Œ ìš´ë™ëŸ‰ì€ ì–´ëŠ ì •ë„ì¸ê°€ìš”?</h2><div class="icon-grid">';
      [['1','ê±°ì˜ ì•ˆ í•¨','exerciseLow'],['2','ê°€ë²¼ìš´ ì‚°ì±…','exerciseMid'],['3','ê·œì¹™ì  ìš´ë™','exerciseHigh']].forEach(function(o){
        h += '<button type="button" class="icon-card' + (profile.exerciseLevel === parseInt(o[0],10) ? ' selected' : '') + '" data-exercise="' + o[0] + '"><span class="icon-wrap">' + ICONS[o[2]] + '</span><span class="icon-label">' + o[1] + '</span></button>';
      });
      h += '</div></section>';
    }
    if (step === 2) {
      h += '<section class="section"><h2>ì—¬í–‰ ì¤‘ íœ´ì‹ì´ ì–¼ë§ˆë‚˜ í•„ìš”í•˜ì‹ ê°€ìš”?</h2><div class="icon-grid">';
      [['1','íœ´ì‹ ì ê²Œ','restLow'],['2','ì ë‹¹íˆ','restMid'],['3','íœ´ì‹ ë§ì´','restHigh']].forEach(function(o){
        h += '<button type="button" class="icon-card' + (profile.restNeed === parseInt(o[0],10) ? ' selected' : '') + '" data-rest="' + o[0] + '"><span class="icon-wrap">' + ICONS[o[2]] + '</span><span class="icon-label">' + o[1] + '</span></button>';
      });
      h += '</div></section><section class="section"><h2>ê±±ì •ë˜ëŠ” ê±´ê°• ì´ìŠˆê°€ ìˆë‹¤ë©´ (ë³µìˆ˜ ì„ íƒ)</h2><div class="icon-grid">';
      [['heart','ì‹¬í˜ˆê´€'],['joint','ê´€ì ˆ'],['sleep','ìˆ˜ë©´/í”¼ë¡œ'],['eye','ëˆˆ/í”¼ë¡œ'],['none','í•´ë‹¹ ì—†ìŒ']].forEach(function(o){
        var sel = (o[0]==='none' ? profile.conditions.length===0 : profile.conditions && profile.conditions.indexOf(o[0])>=0);
        h += '<button type="button" class="icon-card' + (sel ? ' selected' : '') + '" data-condition="' + o[0] + '"><span class="icon-wrap">' + ICONS[o[0]] + '</span><span class="icon-label">' + o[1] + '</span></button>';
      });
      h += '</div></section>';
    }
    if (step === 3) {
      h += '<section class="section"><h2>ì„ í˜¸í•˜ëŠ” ì—¬í–‰ ìŠ¤íƒ€ì¼ (ë³µìˆ˜ ì„ íƒ)</h2><div class="icon-grid">';
      [['activity','í™œë™ì ì¸'],['relax','íœ´ì–‘Â·íœ´ì‹'],['culture','ë¬¸í™”Â·ì—­ì‚¬']].forEach(function(o){
        var sel = profile.travelStyle && profile.travelStyle.indexOf(o[0]) >= 0;
        h += '<button type="button" class="icon-card' + (sel ? ' selected' : '') + '" data-style="' + o[0] + '"><span class="icon-wrap">' + ICONS[o[0]] + '</span><span class="icon-label">' + o[1] + '</span></button>';
      });
      h += '</div></section>';
    }
    if (step === 4) {
      h += '<section class="section"><h2>ê°€ê³  ì‹¶ì€ ì—¬í–‰ì§€ëŠ”?</h2><div class="chip-grid">';
      ['ì œì£¼ë„','ë¶€ì‚°Â·ê²½ë‚¨','ê°•ë¦‰Â·ë™í•´','ì „ì£¼Â·ì „ë¶','ê²½ì£¼','ê¸°íƒ€'].forEach(function(d){
        h += '<button type="button" class="chip' + (profile.destination === d ? ' selected' : '') + '" data-dest="' + d + '">' + d + '</button>';
      });
      h += '</div></section><section class="section"><h2>ì˜ˆìƒ ì—¬í–‰ ê¸°ê°„</h2><div class="chip-grid">';
      [[1,'1ë°• 2ì¼'],[2,'2ë°• 3ì¼'],[3,'3ë°• 4ì¼'],[4,'4ë°• 5ì¼ ì´ìƒ']].forEach(function(o){
        h += '<button type="button" class="chip' + (profile.duration === o[0] ? ' selected' : '') + '" data-duration="' + o[0] + '">' + o[1] + '</button>';
      });
      h += '</div></section>';
    }
    h += '</main><div class="survey-footer">';
    if (step > 1) h += '<button type="button" class="btn-secondary" id="btn-prev">ì´ì „</button>';
    h += '<button type="button" class="btn-primary" id="btn-next">' + (step === 4 ? 'ì—¬í–‰ ì •ë³´ ë³´ê¸°' : 'ë‹¤ìŒ') + '</button></div></div>';
    return h;
  }

  function renderCuration() {
    var dest = profile.destination || 'ì œì£¼ë„';
    var data = CURATION[dest] || CURATION['ì œì£¼ë„'];
    var catKeys = ['accommodation','transport','attraction','food'];
    var catLabels = { accommodation: 'ìˆ™ì†Œ', transport: 'êµí†µ', attraction: 'ê´€ê´‘ì§€', food: 'ìŒì‹' };
    var h = '<div class="page"><header class="curation-header"><h1>ì—¬í–‰ ì •ë³´ íë ˆì´ì…˜</h1><p class="curation-dest">' + dest + '</p><p class="curation-summary">' + data.summary + '</p></header><section class="top3-section"><h2>Top 3 ìš”ì•½</h2><p class="top3-desc">ê° ì¹´í…Œê³ ë¦¬ ìƒìœ„ 3ê³³ì„ ì •ë¦¬í–ˆì–´ìš”.</p><div class="top3-grid">';
    catKeys.forEach(function(k){
      var arr = data[k] || [];
      h += '<div class="top3-card"><span class="top3-label">' + catLabels[k] + '</span><ul class="top3-list">';
      arr.slice(0,3).forEach(function(item){ h += '<li>' + (item.name || item.type) + (item.note ? ' Â· ' + item.note : '') + '</li>'; });
      h += '</ul></div>';
    });
    h += '</div></section><section class="section"><h2>ì¹´í…Œê³ ë¦¬ë³„ ìƒì„¸</h2><div class="tabs">';
    catKeys.forEach(function(k){
      h += '<button type="button" class="tab' + (curCategory === k ? ' active' : '') + '" data-cat="' + k + '">' + catLabels[k] + '</button>';
    });
    h += '</div><div id="curation-list">';
    (data[curCategory] || []).forEach(function(item){
      h += '<div class="list-card"><h3>' + (item.name || item.type) + '</h3>';
      if (item.type) h += '<span style="font-size:0.8rem;color:#666">' + item.type + '</span> ';
      if (item.score) h += '<span style="font-size:0.8rem">â˜… ' + item.score + '</span> ';
      if (item.source) h += '<span style="font-size:0.8rem;color:#666">' + item.source + '</span>';
      if (item.note) h += '<p class="note">' + item.note + '</p>';
      if (item.price) h += '<p class="price">' + item.price + '</p>';
      if (item.tip) h += '<p class="note">ğŸ’¡ ' + item.tip + '</p>';
      if (item.level) h += '<span style="font-size:0.8rem;color:#666">ë‚œì´ë„: ' + item.level + '</span>';
      if (item.tags && item.tags.length) { h += '<p>'; item.tags.forEach(function(t){ h += '<span class="tag">' + t + '</span>'; }); h += '</p>'; }
      h += '</div>';
    });
    h += '</div></section><div class="curation-footer"><a href="#/planner" class="btn-primary">ì´ ì •ë³´ë¡œ ì¼ì • ë§Œë“¤ê¸°</a></div></div>';
    return h;
  }

  function renderPlanner() {
    var it = generateItinerary();
    var h = '<div class="page"><header class="planner-header"><h1>ë§ì¶¤ ì¼ì • í”Œë˜ë„ˆ</h1><p class="planner-meta">' + it.destination + ' Â· ' + it.totalDays + 'ì¼</p><div class="planner-badges"><span class="planner-badge">ë‚œì´ë„: ' + it.difficultyLabel + '</span><span class="planner-badge">í˜ì´ìŠ¤: ' + it.paceLabel + '</span></div></header><section class="planner-tips"><h2>ì´ë²ˆ ì¼ì • íŒ</h2><ul>';
    it.tips.forEach(function(t){ h += '<li>' + t + '</li>'; });
    h += '</ul></section>';
    it.days.forEach(function(day){
      h += '<article class="day-card"><h3>' + day.dateLabel + '</h3><ul style="list-style:none;margin:0;padding:0">';
      day.slots.forEach(function(slot){
        h += '<li class="slot"><span class="slot-time">' + slot.time + '</span><br><span class="slot-label">' + slot.label + '</span>' + (slot.note ? '<br><span class="slot-note">' + slot.note + '</span>' : '') + '</li>';
      });
      h += '</ul></article>';
    });
    h += '<div class="planner-footer"><button type="button" class="btn-secondary" id="btn-regen">ì¼ì • ë‹¤ì‹œ ë§Œë“¤ê¸°</button><p class="planner-hint">í”„ë¡œí•„ì„ ë°”ê¾¸ë©´ ë” ë§ëŠ” ì¼ì •ì´ ë§Œë“¤ì–´ì ¸ìš”.</p></div></div>';
    return h;
  }

  function render() {
    var hash = (location.hash || '#/').slice(1) || 'home';
    var path = hash.split('/')[0] || 'home';
    var app = document.getElementById('app');
    if (path === 'survey') app.innerHTML = renderSurvey();
    else if (path === 'curation') app.innerHTML = renderCuration();
    else if (path === 'planner') app.innerHTML = renderPlanner();
    else app.innerHTML = renderHome();

    document.querySelectorAll('.nav a').forEach(function(a){
      a.classList.remove('active');
      if ((a.getAttribute('href') === '#/' && path === 'home') || (a.getAttribute('href') === '#/' + path)) a.classList.add('active');
    });

    if (path === 'survey') {
      app.querySelectorAll('.icon-card[data-exercise]').forEach(function(btn){
        btn.onclick = function(){ profile.exerciseLevel = parseInt(btn.dataset.exercise,10); saveProfile(); render(); };
      });
      app.querySelectorAll('.icon-card[data-rest]').forEach(function(btn){
        btn.onclick = function(){ profile.restNeed = parseInt(btn.dataset.rest,10); saveProfile(); render(); };
      });
      app.querySelectorAll('.icon-card[data-condition]').forEach(function(btn){
        btn.onclick = function(){
          var v = btn.dataset.condition;
          if (v === 'none') { profile.conditions = []; } else {
            profile.conditions = profile.conditions || [];
            var i = profile.conditions.indexOf(v);
            if (i >= 0) profile.conditions.splice(i,1); else { profile.conditions = profile.conditions.filter(function(c){ return c !== 'none'; }); profile.conditions.push(v); }
          }
          saveProfile(); render();
        };
      });
      app.querySelectorAll('.icon-card[data-style]').forEach(function(btn){
        btn.onclick = function(){
          var v = btn.dataset.style;
          profile.travelStyle = profile.travelStyle || [];
          var i = profile.travelStyle.indexOf(v);
          if (i >= 0) profile.travelStyle.splice(i,1); else profile.travelStyle.push(v);
          saveProfile(); render();
        };
      });
      app.querySelectorAll('.chip[data-dest]').forEach(function(btn){
        btn.onclick = function(){ profile.destination = btn.dataset.dest; saveProfile(); render(); };
      });
      app.querySelectorAll('.chip[data-duration]').forEach(function(btn){
        btn.onclick = function(){ profile.duration = parseInt(btn.dataset.duration,10); saveProfile(); render(); };
      });
      var btnNext = document.getElementById('btn-next');
      if (btnNext) btnNext.onclick = function(){ if (step < 4) { step++; render(); } else { location.hash = '#/curation'; render(); } };
      var btnPrev = document.getElementById('btn-prev');
      if (btnPrev) btnPrev.onclick = function(){ if (step > 1) { step--; render(); } };
    }

    if (path === 'curation') {
      app.querySelectorAll('.tab[data-cat]').forEach(function(btn){
        btn.onclick = function(){ curCategory = btn.dataset.cat; render(); };
      });
    }

    if (path === 'planner') {
      var btnRegen = document.getElementById('btn-regen');
      if (btnRegen) btnRegen.onclick = function(){ itineraryKey++; render(); };
    }
  }

  var lastPath = '';
  function onRoute() {
    var hash = (location.hash || '#/').slice(1) || 'home';
    var path = hash.split('/')[0] || 'home';
    if (path === 'survey' && lastPath !== 'survey') step = 1;
    lastPath = path;
    render();
  }
  window.addEventListener('hashchange', onRoute);
  window.addEventListener('load', function(){ onRoute(); });
})();
  </script>
</body>
</html>
